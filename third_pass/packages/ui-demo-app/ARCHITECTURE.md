# UI Demo App Architecture

## Overview

The UI Demo App is a modern React application built to showcase and validate Figma-generated components. It provides visual comparison tools, performance metrics, and an interactive playground for testing generated code.

## Technology Stack

### Core Framework
- **React 19.1.1** - Latest React with concurrent features and improved performance
- **TypeScript 5.9.3** - Strict mode enabled for maximum type safety
- **Vite 7.1.7** - Lightning-fast build tool with HMR

### Routing
- **Tanstack Router 1.134+** - Type-safe file-based routing
  - Auto-generated route tree
  - Automatic code splitting per route
  - Type-safe navigation and search params
  - Active link styling with `activeProps`

### Styling
- **Tailwind CSS 4.1.17** - Utility-first CSS with modern features
  - CSS variables for theming
  - OKLch color space
  - Dark mode support
  - `@tailwindcss/vite` plugin for optimal integration

### Component Library
- **ShadCN 3** - Accessible, customizable components
  - Built on Radix UI primitives
  - Copy-paste component approach
  - Full TypeScript support
  - Tailwind-based styling

### Icons
- **Lucide React** - Modern icon library with 1000+ icons

## Project Structure

```
ui-demo-app/
├── src/
│   ├── routes/              # File-based routing
│   │   ├── __root.tsx       # Root layout (navigation, Outlet)
│   │   ├── index.tsx        # Home page
│   │   ├── components.tsx   # Component showcase
│   │   ├── visual-diff.tsx  # Visual diff viewer
│   │   ├── metrics.tsx      # Metrics dashboard
│   │   └── playground.tsx   # Code playground
│   ├── lib/
│   │   └── utils.ts         # Utility functions (cn)
│   ├── index.css            # Tailwind + design tokens
│   ├── main.tsx             # App entry point
│   ├── routeTree.gen.ts     # Auto-generated by Tanstack Router
│   └── vite-env.d.ts        # Vite type definitions
├── components.json          # ShadCN configuration
├── vite.config.ts           # Vite + plugins config
├── tsconfig.json            # TypeScript project references
├── tsconfig.app.json        # App TypeScript config
├── tsconfig.node.json       # Build tools TypeScript config
├── eslint.config.js         # ESLint flat config
├── package.json             # Dependencies and scripts
└── index.html               # HTML entry point
```

## Design System

### Color Palette

Using OKLch color space for better color manipulation:

**Light Mode:**
- Primary: `oklch(0.541 0.247 293.009)` - Purple-600
- Background: `oklch(1.000 0.000 0)` - White
- Foreground: `oklch(0.235 0.000 0)` - Near-black

**Dark Mode:**
- Primary: `oklch(0.664 0.163 296.963)` - Purple-400
- Background: `oklch(0.235 0.000 0)` - Near-black
- Foreground: `oklch(1.000 0.000 0)` - White

### Design Tokens

All colors are defined as CSS variables for easy theming:

```css
--background
--foreground
--primary
--secondary
--muted
--accent
--destructive
--border
--input
--ring
```

### Border Radius

```css
--radius: 0.625rem (10px)
--radius-sm: 6px
--radius-md: 8px
--radius-lg: 10px
--radius-xl: 14px
```

## Routing Architecture

### File-Based Routing

Routes are automatically generated from the file structure:

```
src/routes/index.tsx → /
src/routes/components.tsx → /components
src/routes/visual-diff.tsx → /visual-diff
src/routes/metrics.tsx → /metrics
src/routes/playground.tsx → /playground
```

### Route Tree

The route tree is auto-generated by `@tanstack/router-plugin`:

```typescript
export const routeTree = rootRoute.addChildren({
  IndexRoute,
  ComponentsRoute,
  MetricsRoute,
  PlaygroundRoute,
  VisualDiffRoute,
})
```

### Type Safety

All routes are fully type-safe with auto-generated types:

```typescript
interface FileRoutesByPath {
  '/': { id: '/', path: '/', ... }
  '/components': { id: '/components', path: '/components', ... }
  // ... etc
}
```

## Pages Overview

### 1. Home Page (`/`)

**Purpose:** Landing page with app overview

**Features:**
- Hero section with gradient text
- Feature cards linking to main pages
- Quick statistics dashboard
- Responsive grid layout

**Components:**
- `FeatureCard` - Feature overview with icon
- `StatItem` - Metric display

### 2. Component Showcase (`/components`)

**Purpose:** Browse and filter generated components

**Features:**
- Search by component name
- Filter by category
- Grid/List view toggle
- Component status badges
- Component preview placeholders

**State Management:**
- `viewMode` - Grid or list view
- `searchQuery` - Search input
- `selectedCategory` - Category filter

**Components:**
- `ComponentCard` - Component display card

### 3. Visual Diff Viewer (`/visual-diff`)

**Purpose:** Compare Figma designs with rendered components

**Features:**
- Side-by-side comparison mode
- Split view with draggable slider
- Similarity percentage score
- Navigation between components
- Fullscreen and export options

**View Modes:**
- `side-by-side` - Two panels
- `split` - Overlay with slider

**Components:**
- `ComparisonPanel` - Single comparison view

### 4. Metrics Dashboard (`/metrics`)

**Purpose:** Monitor pipeline performance

**Features:**
- Key metric cards with trends
- Recent generations table
- Chart placeholders
- Status indicators
- Trend indicators (up/down)

**Metrics Tracked:**
- Total generations
- Success rate
- Average latency
- Total cost

**Components:**
- `MetricCard` - Metric display with trend
- `GenerationRow` - Table row for generation

### 5. Code Playground (`/playground`)

**Purpose:** Live code editor for generated components

**Features:**
- Code editor (textarea)
- Live preview panel
- Run/Reset/Copy/Download actions
- Component selector
- Error display

**State Management:**
- `code` - Editor content
- `error` - Compilation errors

**Components:**
- `ComponentChip` - Component selector button

## Data Flow

### Current State (Mock Data)

All pages use mock data defined in-file:

```typescript
const mockComponents = [...]
const mockMetrics = {...}
const mockComparisons = [...]
```

### Future State (Pipeline Integration)

```
Validation Pipeline
    ↓
Generated Components + Metadata
    ↓
UI Demo App
    ↓
Display / Compare / Test
```

Integration points:
1. Load component list from pipeline output
2. Fetch Figma export images
3. Collect generation metrics
4. Load component source code

## Performance Considerations

### Code Splitting

- Automatic per-route code splitting via Tanstack Router
- Each page loads only its required code
- Shared dependencies bundled separately

### Bundle Size Targets

- Total bundle: < 500KB gzipped
- Initial load: < 200KB
- Per-route chunks: < 100KB

### Load Time Targets

- First Contentful Paint: < 1s
- Time to Interactive: < 3s
- Total load time: < 2s on 3G

### Optimization Strategies

1. **Route-based code splitting** - ✅ Implemented
2. **CSS-in-JS avoided** - ✅ Using Tailwind
3. **Tree shaking** - ✅ Via Vite
4. **Dynamic imports** - Future: Load heavy components on-demand
5. **Image optimization** - Future: WebP/AVIF, lazy loading

## Build Process

### Development

```bash
pnpm dev
```

- Vite dev server on port 5173
- Hot Module Replacement (HMR)
- Fast refresh for React components
- Tanstack Router generates route tree automatically

### Production Build

```bash
pnpm build
```

1. TypeScript compilation check
2. Vite bundles for production
3. CSS purged and minified
4. JS minified with Rollup
5. Route tree frozen

### Build Output

```
dist/
├── assets/
│   ├── index-[hash].js
│   ├── index-[hash].css
│   └── [route]-[hash].js
└── index.html
```

## Integration Points

### With Validation Pipeline

```typescript
import { ValidationPipeline } from '@zephyr/validation-pipeline'

// Load components
const components = await pipeline.getGeneratedComponents()

// Load metrics
const metrics = await pipeline.getMetrics()

// Load Figma exports
const figmaImage = await pipeline.getFigmaExport(nodeId)
```

### With Figma API (Future)

```typescript
// Direct Figma integration
const figmaClient = new FigmaClient(token)
const image = await figmaClient.getImage(fileId, nodeId)
```

## Extension Points

### Adding New Routes

1. Create `src/routes/new-route.tsx`
2. Export route using `createFileRoute('/new-route')`
3. Route tree auto-updates on next dev server start

### Adding New Components

```bash
npx shadcn@latest add <component-name>
```

Components added to `src/components/ui/`

### Adding New Metrics

Update mock data structure and metric card layout:

```typescript
const newMetric = {
  title: 'New Metric',
  value: '123',
  trend: 5.2,
  icon: <Icon />
}
```

## Testing Strategy

### Unit Tests (Future)

- Component rendering tests
- Utility function tests
- Mock data validation

### Integration Tests (Future)

- Route navigation
- Search/filter functionality
- Visual diff interactions

### E2E Tests (Future)

- Full user workflows
- Visual regression testing
- Performance testing

## Deployment

### Current: Local Development

```bash
pnpm dev
```

### Future: Static Hosting

Build and deploy to:
- Vercel
- Netlify
- Cloudflare Pages
- GitHub Pages

### Future: SSR with Tanstack Start

If SSR becomes a requirement, migration path:
1. Install `@tanstack/start`
2. Update routing to use SSR features
3. Add server-side data fetching
4. Deploy to Node.js hosting

## Security Considerations

### Current

- No authentication required (local app)
- No sensitive data handling
- Client-side only

### Future

- Add authentication if deployed
- Secure API endpoints
- Rate limiting for Figma API
- Content Security Policy

## Accessibility

### Current Implementation

- Semantic HTML structure
- Keyboard navigation support (native)
- Color contrast (WCAG AA)
- Lucide icons (accessible)

### Future Improvements

- Add ARIA labels
- Screen reader testing
- Keyboard shortcuts
- Focus management

## Browser Support

- Chrome/Edge (last 2 versions)
- Firefox (last 2 versions)
- Safari (last 2 versions)
- No IE11 support (uses modern ES2022)

## Development Guidelines

### Code Style

- TypeScript strict mode
- ESLint with React hooks rules
- Prettier formatting (via eslint-config-prettier)
- 2-space indentation

### Naming Conventions

- Components: PascalCase (`ComponentCard.tsx`)
- Utilities: camelCase (`cn`, `formatDate`)
- Routes: kebab-case (`visual-diff.tsx`)
- CSS classes: Tailwind utilities

### Component Structure

```typescript
// 1. Imports
import { ... } from '...'

// 2. Route definition
export const Route = createFileRoute('/path')({
  component: ComponentName
})

// 3. Main component
function ComponentName() {
  // State
  const [state, setState] = useState(...)

  // Handlers
  const handleEvent = () => {...}

  // Render
  return (...)
}

// 4. Sub-components
interface SubComponentProps {...}
function SubComponent(props: SubComponentProps) {...}
```

## Monitoring & Analytics

### Future Additions

- Error tracking (Sentry)
- Performance monitoring (Web Vitals)
- User analytics (PostHog, Plausible)
- Custom event tracking

## Troubleshooting

### Common Issues

1. **Port in use:** Vite auto-selects next port
2. **TypeScript errors:** Run `pnpm typecheck`
3. **Missing route tree:** Restart dev server
4. **ShadCN not found:** Run `npx shadcn@latest add <component>`

### Debug Mode

Set `DEBUG=*` environment variable for verbose logging

## Resources

- [Project README](./README.md)
- [Setup Guide](./SETUP.md)
- [Tanstack Router Docs](https://tanstack.com/router/latest)
- [Tailwind 4 Docs](https://tailwindcss.com/docs)
- [ShadCN Docs](https://ui.shadcn.com/)
